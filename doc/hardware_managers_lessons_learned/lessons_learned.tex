
\section{Lessons learned}\label{sec:lessons}
Here I have listed the lessons I learned during the project that I want to share with others.

\subsection{Leave your ego at home}\label{sec:ego}
Throughout the course of a project like this you will participate in many discussions. Many times there will be people that think differently than you do. More importantly, \emph{there will be times when you are wrong}. When those who oppose you have valid arguments, you have to reconsider if you really are right. \\
Don't be afraid to acknowledge that you are wrong. Keep an open mind and focus on factual arguments rather than taking anything personal. \\
Remember that design choices should never be determined by the egos of individuals in the group.


\subsection{Listen to your colleges}\label{sec:listen}
Early on I realized that even though I was the manager of the hardware team, I still did not know particularly much more than anybody else in the team. Therefore I frequently discussed the decisions I took with my colleagues and I was very clear that I wanted feedback. If somebody realized that I had taken a bad decision then I wanted that person to tell me this so that I could make better decisions, etc. \\
I believe that this was a very good thing to do. There were many times when members of my team come to me and told me that a decision I had made were not the best, which often helped to avoid many mistakes. \\
This lesson is closely related with Section~\ref{sec:ego}.


\subsection{Define roles of management and follow them}\label{sec:roles}
As mentioned, there was in practise no clear manager over the software group. This does not, to me, seem to have affected the work of the software group itself in any negative way. However this had in fact an effect on the project as a whole. \\
During the project, I often needed to talk to the software group about how the firmware should interface with the software. An example of this is the Motion controller (software) that uses Motor controllers (firmware and hardware) to control the motors, I saw this as the Motor controllers offering a service to the Motion controller. \\
Whenever I needed to talk to the software group about a certain subject I would to talk to the individual that was responsible for this particular subject, which meant that the person I talked to didn't have an overall understanding of the software group's work and I never really got the the whole picture. Had there been a software manager, I could have spoken to him/her and we would together have had a much better over-all picture of how the firmware-to-software interface should be.

The interface between hardware and software should be discussed between the hardware and software managers (and also  possibly the overall project manager) and not between individuals in each group. Please see Section~\ref{sec:firmware} for more about this.


\subsection{Define software standards and follow them}\label{sec:software_standards}
Regarding software standards, I am not too concerned about coding styles such as whether one should use underlines or not (e.g. \emph{my\_variable} or \emph{myVariable}), even though these types of standards do improve readability. \\
More concern should be put into what the overall structure of the whole body of code should look like. This includes a folder structure (e.g. one folder for hardware specific drivers, with subfolders for each hardware, one folder for platform independent code, and so on) how different parts of the code depend on each other and so forth.

Please note that these definitions will in turn be further defined in Section~\ref{sec:define} and that this lesson also is associated with Section~\ref{sec:top_down}.

Once the software structure and coding standards are decided, one has to make sure that they are followed properly. I  advice the Software manager to read all code that his subordinates write. This will enable him/her to ensure that the code is written in a good way. This will also give the Software manager a better overview of all the software that is written during the project. \\
If somebody thinks there should be changes made in the coding standards or the structure of the software, then this should be discussed in the whole project group and a decision should be made. Individuals should avoid to deviate from the decided standards at their own initiative.


\subsection{Use a top down design flow}\label{sec:top_down}
A system such as an AUV, or any other robot developed during this course will be a system of subsystems where the subsystems are dependent of each other. For this reason it is important to first define the subsystems and their interfaces before starting to develop each subsystem. \\
If one does the opposite, first developing a subsystem and then define its interface, then this subsystem will have to be finished before any other subsystem (that is to interface with the subsystem) can be developed. 


\subsection{Clearly define each subsystem and its interface}\label{sec:define}
As mentioned in Section~\ref{sec:top_down}, in a project of this size there will be many different subsystem that will be created by different people but still have to work together in the end. An example of this is the Motion Control subsystem that interfaces with each Motor controller that in turn controls the motors. \\
It is of the utmost importance that the person(s) that build one subsystem (i.e. the Motion Control) knows what to expect from the subsystem(s) (i.e. the Motor Control) that their subsystem uses. There has been several instances throughout the project where one subsystem has been created to solve one function and those who are to use this subsystem have understood that it would solve a slightly different task. 

I recommend defining a set of tests for each subsystem at an early state, before the subsystems are developed.
This will both help the person(s) developing the subsystem and help others understand what the subsystem will do. 
Defining User stories~\cite{web:wiki_user_story} and/or Integration tests~\cite{web:wiki_integration_testing} that will be used later on in the development cycle (testing phase) are good ways for the project team to define the goals for the different subsystems. \\
I also encourage that the process of defining each subsystem, their interfaces and tests is done by several people and that what is decided is then presented to the whole project group so that anyone can come with suggestions or ideas.


\subsection{Firmware is software}\label{sec:firmware}
As mentioned, there were several possible definitions of firmware and firmware could be considered either software or hardware. In any case, each piece of firmware will need to interface with to two things: the hardware (the Sensor controller needs to interface to its sensors, the Motorcontroller needs to interface with the motors, etc.) and to the software (e.g. Motion control, Mission control, Simulator, etc). \\
I have come to realize that the firmware-software interface is more complex than the firmware-hardware interface. The reason for this is that the firmware-hardware interface is specific to each subsystem, for example: the person writing the Sensor controller firmware only needs to talk to the person building the Sensor controller hardware (choosing sensors and building interface circuits, etc). Whereas the firmware-software interface is more general. This is discussed in Sections~\ref{sec:software_standards},~\ref{sec:top_down} and~\ref{sec:define}.


\subsection{Have a person responsible for sponsorship only}
The work of getting sponsors is enough work for at least one person throughout the project. This person should not have other duties.

\subsection{Individuals will make mistakes}
The well known fact that "To err is human" has been apparent during this project, not only others but also myself have made mistakes that have had negative consequences for the project. \\ 
I have realized that when working in a project such as this project course, one has to remember that any individual can make mistakes. For this reason one has to work in a way such that the mistakes of an individual do not become a mistake of the whole project group, mistakes need to be found and corrected. This can sometimes be hard to do in practice since assuming that a person could make a mistake can be interpreted by that person that one does not trust him/her. For this reason, this lesson is closely related to Section~\ref{sec:ego}, each person has to realize that he/she can make mistakes and allow others to check his/her work. \\
For managers (software, hardware and overall managers) this lesson also closely relates to Section~\ref{sec:listen}.


\subsection{Talk to the client about requirements}\label{sec:client}
During the project it became apparent that several of the "hard" requirements given by the client were not so hard at all. Neither did all the requirements seem as thought through as they first appeared. Several of the requirements turned out to be more of "nice to have" rather than "need to have", for example the robot-to-robot communication, IP-over-CAN, the use of space-plug-and-play, etc. \\

The same is likely to be true in following project courses. Consequently, I strongly advice future students of this project course to look carefully at the given requirements, analyze them so that their purposes are fully understood and prioritize them. Once this is done, requirements that either seem to be to hard to fulfil or that have low priority should be left for later evaluation. It is better to start with a few important requirements than trying to meet all from the beginning. \\
All this should be done in collaboration with the customer.

This lesson is closely related to Section~\ref{sec:time}.

\subsection{Time is precious}\label{sec:time}
There is a lot of work that needs to be done during a project such as this one. Even though each student is meant to put in a lot of time into the project, one will soon find that one will only have time for a fraction of what one first thought that one would be able to do. \\
One principle that was mentioned during the project was "Take whatever time you think something is going to take, multiply by $\pi$ and round up". This was said as a joke but in some instances it was not too far from reality. \\
For these reasons, one has to be very selective on what to spend time on. This applies for each person on all levels of the project.

\subsection{Acquire equipment early}\label{sec:equipment}
During the course of a project such as the Naiad AUV project several different kinds of equipment will be needed, some of which are crucial to the project's success. One such piece of equipment is a programmer for the microcontrollers used in the project. The Naiad AUV project used AT90CAN128 microcontrollers programmed by a JTAGICE MKII programmer. \\
Students of future projects should make sure to get access to programmers for the microcontrollers that are to be used as soon as possible. The Naiad AUV project had only access to one programmer, which proved to be far from enough.

As mentioned earlier in this report, testing is important. There will undoubtedly be times when things don't work. \\
Unlike software development, where much testing can be done "in software" using Unit testing~\cite{web:wiki_unit_testing} or simple text outputs to the screen, development of electronics and embedded software (or firmware, see Section~\ref{sec:firmware}) often requires hardware for testing.

Embedded systems are generally not connected to a computer screen. For this reason, one needs some other method to retrieve debug output from the system. \\
The simplest way for microcontrollers such as the AT90CAN128 used in the Naiad AUV to communicate with the "outside world" (usually a human looking at a computer screen) is via UART. For this reason it is of vital importance to have access to some form of UART-to-USB converters, i.e. a way of creating a comport on the PC that is connected to the UART bus on the microcontroller. Terminal software such as Bray's Terminal~\cite{web:brays_terminal} or  CuteCom~\cite{web:cutecom_terminal} will be needed for this. \\
Section~\ref{sec:testing} goes into more detail about this.

For debugging the CAN bus, which future student projects at M\"{a}lardalen University are also likely to use, hardware such as the Kvaser Leaf CAN-to-USB interface~\cite{web:kvaser_can} will be needed to monitor subsystems on the CAN bus. This type of hardware can also be used to emulate one subsystem when testing another subsystem. For example, during this project we sent faked motor control messages to the Motor controller and checked that the motor's speed changed according to the control messages.

For testing electronics, equipment such as oscilloscopes, multimeters, function generators and voltage sources is necessary.

When a student project begins, make sure that you get access to the equipment that you will need as soon as possible.  Make sure to remind those you request equipment (or other things) from very often, if not daily. \\
There will often be a delay from that you request to get something till you actually get it. Keep in mind that this delay is highly likely to be longer than you expect. When something gets delayed, make sure that you find out exactly what (or who) is causing the delay. This will make it easier to figure out how to speed things up. \\
Ask nicely, but make sure that you are firm and determined to get the equipment you need, be clear that you are expected to achieve very high goals and that you cannot do so if you don't have the resources needed to do so.


\subsection{Think of testing when designing hardware}\label{sec:testing}
Make sure that you keep debugging and testing in mind from the beginning in the design process of any form of electronics. As mentioned in Section~\ref{sec:equipment}, testing and debugging embedded systems is often hard. 

Remember to build the hardware to enable access to at least one UART bus on the microcontroller(s). This way you can output debug information to a PC (using a UART-to-USB converter, see Section~\ref{sec:equipment}) when the system is running. \\
When building circuits that will interface each other\footnote{Such as the Inertial Measurement Unit that communicates over UART with the AT90CAN128 on the INS controller.} it is a very good idea to connect their interface pins (the Tx and Rx pins in the case of UART) to some form of connector (simple break of header pins for example). This way you can monitor the communication. \\
In the case of UART you will connect the Rx pin (the pin that "listens") of your UART-to-USB converter to one of the pins of the UART bus. If you want to monitor both pins at the same time you will need two UART-to-USB converters.

The above will apply for prototype versions of a circuit board, but it might be a good idea to have this on the final version as well. For example, if someone in the future develops new software/firmware for your hardware they might very well have great use of being able to output debug information on a UART bus.


